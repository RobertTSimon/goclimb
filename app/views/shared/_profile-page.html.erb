<div class="full-height page-profile" id="profile-page">
  <div class="profile-card" id="profile-avatar">
    <h2>Profile</h2>
    <%= image_tag @user.avatar_photo, width: 100, height: 100, crop: :fill, radius: "max", id: "profile-settings-avatar"%>
    <div class="user-info">
      <p><strong>Name:  </strong><%= @user.username %></p>
      <p><strong>Bio:  </strong>"<%= @user.bio %>"</p>
      <p><strong>Location:   </strong><%= @user.location %></p>
      <p><strong>Level:   </strong><%= @user.current_level %></p>
      <p><strong>Favourite Styles:   </strong>"<%= @user.favorite_styles %>"</p>
      <!-- <p><strong>Following:    </strong></p> -->
      <!-- <p><strong>Followed By:    </strong></p> -->
      <% if (@user.id != current_user.id && !@user.followed_by.include?(current_user.id))%>
        <%= link_to "Follow", add_follower_path(@user), class: "btn btn-primary" %>
      <% elsif (@user.id != current_user.id && @user.followed_by.include?(current_user.id)) %>
        <%= link_to "Unfollow", delete_follower_path(@user), class: "btn btn-primary" %>
      <% end %>


   
      <% if @user.id != current_user.id %>
        <%= link_to "Invite to next trip", "/trips/#{current_user.trips.order(id: :asc).first.id}/joint_user_trips?user_id=#{@user.id}", method: :post, class: "btn btn-primary" %>
      <% end %>


      <h3>Following:</h3>

      <% if @user.following.present? %>
          <% @user.following.each do |follower_id| %>
            <a href="<%= profile_path(follower_id) %>"><%= image_tag User.find(follower_id).avatar_photo, width: 50, height: 50 %></a>
          <% end %>
      <% end %>

      <h3>Followers:</h3>
      <% if @user.followed_by.present? %>
          <% @user.followed_by.each do |user_id| %>
            <a href="<%= profile_path(user_id) %>"><%= image_tag User.find(user_id).avatar_photo, width: 50, height: 50 %></a>
          <% end %>
      <% end %>
    </div>
  </div>
  <div class="d-flex profile route-setter-page">
    <div class="cards-route" id="sport-cards-index">
      <h2>Trips</h2>
        <h4>Your Invites :</h4>

      <div class="card-route" id="card-route-setter-page">
        <% if current_user.id == @user.id %>
      
          <% current_user.joint_user_trips.where(status: 'pending').each do |jut| %>
            <div style="position:relative;">
              <h4 style="position:absolute; top: 50px; right: 50px; z-index:1000; background-color: white; opacity: 0.5">Your Next Trip with <%= jut.trip.user.username %>  ?
            
            <%= simple_form_for [jut.trip, jut] do |f| %>
              <%= f.submit "Accept", class:"btn btn-outline-success" %>
              <%= f.submit "Refuse", class:"btn btn-outline-danger" %>
            <% end %>
              </h4>
              <%= link_to trip_path(jut.trip) do %>
                <div class="card-route" id="card-route-setter-page">
                  <%= image_tag jut.trip.routes.first.photos.first.photo_url unless jut.trip.routes.first.nil? %>
                  <div class="card-route-info">
                    <div>
                      <h2>Start date :<%= jut.trip.start_date %> -- End date: <%= jut.trip.end_date %></h2>
                    </div>
                  </div>
                </div>
              <% end %>

          </div>
          <% end %>
        <% end %>

      </div>
      <% @next_trip.each do |trip|%>
          <h4>Your Next Trip :</h4>
          <%= link_to trip_path(trip) do %>
            <div class="card-route" id="card-route-setter-page">
              <%= image_tag trip.routes.first.photos.first.photo_url unless trip.routes.first.nil? %>
              <div class="card-route-info">
                <div>
                  <h2>Start date :<%= trip.start_date %> -- End date: <%= trip.end_date %></h2>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
        <h4>Your Past Trips :</h4>
        <% @old_trips.each do |trip|%>
        <%= link_to trip_path(trip) do %>
          <div class="card-route" id="card-route-setter-page">
            <%= image_tag trip.routes.first.photos.first.photo_url unless trip.routes.first.nil? %>
            <div class="card-route-info">
              <div>
                <h2>Start date :<%= trip.start_date %> -- End date: <%= trip.end_date %></h2>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
   </div>
 </div>
</div>





